<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Qsoft: images Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Qsoft
   &#160;<span id="projectnumber">9.0</span>
   </div>
   <div id="projectbrief">Data analysis and modelling for X-ray Astronomy</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">images Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for image display and manipulation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimages_1_1bdata.html">bdata</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimages_1_1iposition.html">iposition</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac92b24c860ad521a28ab90e93ca5abfb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#ac92b24c860ad521a28ab90e93ca5abfb">init</a> ()</td></tr>
<tr class="separator:ac92b24c860ad521a28ab90e93ca5abfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1351dead951fa6728f4f26e6471859"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a4f1351dead951fa6728f4f26e6471859">reset</a> ()</td></tr>
<tr class="separator:a4f1351dead951fa6728f4f26e6471859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef48128ba9b2f8644c43c09f80f20fa0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#aef48128ba9b2f8644c43c09f80f20fa0">rectangles</a> (x, y, w, h, t)</td></tr>
<tr class="separator:aef48128ba9b2f8644c43c09f80f20fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af631fb0f1f2077642b9a988d0bff71e7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#af631fb0f1f2077642b9a988d0bff71e7">binxy</a> (x, y, iq, w, xleft, xright, ybot, ytop, nx, ny)</td></tr>
<tr class="separator:af631fb0f1f2077642b9a988d0bff71e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8faa811be5f0e7dea19b18e20bbc76e9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a8faa811be5f0e7dea19b18e20bbc76e9">quaderr</a> (x0, y0, x1, y1, y)</td></tr>
<tr class="separator:a8faa811be5f0e7dea19b18e20bbc76e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce1b8de9c2c387025e825e92846dc13"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a7ce1b8de9c2c387025e825e92846dc13">srchmin</a> (pars, pl, ph, stat, delstat, derr)</td></tr>
<tr class="separator:a7ce1b8de9c2c387025e825e92846dc13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c9d2cea3fe9a06533d6823fb7065d2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#ae7c9d2cea3fe9a06533d6823fb7065d2">peakchisq</a> (fpars)</td></tr>
<tr class="separator:ae7c9d2cea3fe9a06533d6823fb7065d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c1032a597aef7de43c3a8eaa61f9ceb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a9c1032a597aef7de43c3a8eaa61f9ceb">beam</a> (arr, rbeam, blev, bvar)</td></tr>
<tr class="separator:a9c1032a597aef7de43c3a8eaa61f9ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af968ed455d536c5be4a28b5984765f3d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#af968ed455d536c5be4a28b5984765f3d">lecbeam</a> (arr, s, h, blev, bvar, nt)</td></tr>
<tr class="separator:af968ed455d536c5be4a28b5984765f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09118bff749ce221bcab7cbc813f3e5e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a09118bff749ce221bcab7cbc813f3e5e">lecimage</a> (s, h, b, xcen, ycen, nx, ny)</td></tr>
<tr class="separator:a09118bff749ce221bcab7cbc813f3e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf1baa121ee75e999c92c7f23b7dc42e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#abf1baa121ee75e999c92c7f23b7dc42e">lepsf</a> (s, h, g, eta, xcen, ycen, nx, ny)</td></tr>
<tr class="separator:abf1baa121ee75e999c92c7f23b7dc42e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79aa7fa090e0f357563943c408dab1da"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a79aa7fa090e0f357563943c408dab1da">lebin</a> (xe, ye, s, h, g, eta, nx, ny)</td></tr>
<tr class="separator:a79aa7fa090e0f357563943c408dab1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0ccac946edc83732a3f3d384923ecd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a3b0ccac946edc83732a3f3d384923ecd">setfield</a> (nx, xleft, xright, ny, ybot, ytop)</td></tr>
<tr class="separator:a3b0ccac946edc83732a3f3d384923ecd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6713340c9393df65d12c8950f974f4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a7d6713340c9393df65d12c8950f974f4">setsky</a> (xtodeg, ytodeg, ipr, mjd, ra, dec, roll)</td></tr>
<tr class="separator:a7d6713340c9393df65d12c8950f974f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c53030859724daa5e9f1a7ff57ecf3a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a3c53030859724daa5e9f1a7ff57ecf3a">setpos</a> (ipos, p)</td></tr>
<tr class="separator:a3c53030859724daa5e9f1a7ff57ecf3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e557404e1d244d054cf8aa9cf903904"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a2e557404e1d244d054cf8aa9cf903904">getpos</a> ()</td></tr>
<tr class="separator:a2e557404e1d244d054cf8aa9cf903904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4b780aa3a5620fdc96c7d8c5e7be4e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#a5a4b780aa3a5620fdc96c7d8c5e7be4e">toxy</a> (ipos, p)</td></tr>
<tr class="separator:a5a4b780aa3a5620fdc96c7d8c5e7be4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd0737141ef5575ecbc9c1ad9ac96704"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#afd0737141ef5575ecbc9c1ad9ac96704">hamgrid</a> (pic)</td></tr>
<tr class="separator:afd0737141ef5575ecbc9c1ad9ac96704"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad402eee968601fff4f6274f444c60b94"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceimages.html#ad402eee968601fff4f6274f444c60b94">lamgrid</a> (pic)</td></tr>
<tr class="separator:ad402eee968601fff4f6274f444c60b94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for image display and manipulation. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9c1032a597aef7de43c3a8eaa61f9ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c1032a597aef7de43c3a8eaa61f9ceb">&#9670;&nbsp;</a></span>beam()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.beam </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rbeam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bvar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Analysis of source above background within a circular beam
    arr      image array
    rbeam    radius of beam in pixels
    blev     average background level per pixel (to be subtracted)
    bvar     variance on blev (-ve for counting statistics)
return   list with the following:
    nsam     number of pixels in beam
    bflux    background in beam (e.g. counts)
    bsigma   standard deviation of background
    flux     source flux above background in beam (e.g. counts)
    fsigma   standard deviation of source flux
    peak     source x,y peak position
    cen      source x,y centroid position
    tha      angle (degrees) of major axis wrt x (x to y +ve)
    rmsa     source max rms width (major axis) (pixels)
    rmsb     source min rms width (minor axis) (pixels)
    fwhm     full width half maximum (pixels) about beam centre
    hew      half energy width (pixels) about beam centre
    w90      W90 (90% width) (pixels) about beam centre
    fwhmp    full width half maximum (pixels) about peak
    hewp     half energy width (pixels) about peak
    w90p     W90 (90% width) (pixels) about peak
    fwhmc    full width half maximum (pixels) about centroid
    hewc     half energy width (pixels) about centroid
    w90c     W90 (90% width) (pixels) about centroid
    fit      parameters from peak fit using peakchisq() 
The position of the beam is the current position within the image. Use function setpos() to set the current position.
</pre> 
</div>
</div>
<a id="af631fb0f1f2077642b9a988d0bff71e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af631fb0f1f2077642b9a988d0bff71e7">&#9670;&nbsp;</a></span>binxy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.binxy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xleft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xright</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ybot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ytop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">x-y event binning to form an image
    x      array of x positions
    Y      array of y positions
    iq     array of quality values (0 for OK)
    w      array of weights
    xleft  minimum x value (left edge) for image array
    xright maximum x value (rigth edge) for image array
    ybot   minimum y value (bottom edge) for image array
    ytop   maximum y value (top edge) for image array
    nx,ny  dimensions of output array
return image array
    R version returns an image object - image array object$data_array
</pre> 
</div>
</div>
<a id="a2e557404e1d244d054cf8aa9cf903904"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e557404e1d244d054cf8aa9cf903904">&#9670;&nbsp;</a></span>getpos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.getpos </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get current position in image field
return   list with following:
    pix      pixel position
    xyl      local position
    aes      local azimuth,elevation degrees
    equ      Celestial RA,DEC degrees J2000
    ecl      Ecliptic EA,EL degrees
    gal      Galactic LII,BII degrees
</pre> 
</div>
</div>
<a id="afd0737141ef5575ecbc9c1ad9ac96704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd0737141ef5575ecbc9c1ad9ac96704">&#9670;&nbsp;</a></span>hamgrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.hamgrid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Plot a Hammer projection grid on figure
    pic     figure object
</pre> 
</div>
</div>
<a id="ac92b24c860ad521a28ab90e93ca5abfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac92b24c860ad521a28ab90e93ca5abfb">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialise common blocks on import</pre> 
</div>
</div>
<a id="ad402eee968601fff4f6274f444c60b94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad402eee968601fff4f6274f444c60b94">&#9670;&nbsp;</a></span>lamgrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.lamgrid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Plot a Lambert projection grid on figure
    pic     figure object
</pre> 
</div>
</div>
<a id="a79aa7fa090e0f357563943c408dab1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79aa7fa090e0f357563943c408dab1da">&#9670;&nbsp;</a></span>lebin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.lebin </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ye</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create an image from an event list using lobster eye psf
    xe       x event positions, pixels
    ye       y event positions, pixels
    s       size of cross-beam square area in pixels
    h       height of cross-arm triangle in pixels (=2d/L)
    g       width of Lorentzian central spot in pixels
    eta     cross-arm to peak ratio at centre
    nx      first dimension of array
    ny      second dimension of array
return  image array
    Event positions assumed to run:
        x 0 left edge to nx right edge
        y 0 bottom edge to ny top edge
    Therefore centre of left bottom pixel is 0.5,0.5
    The binning is effectively a cross-correlation of the event list with the lobster eye cross-beam.
</pre> 
</div>
</div>
<a id="af968ed455d536c5be4a28b5984765f3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af968ed455d536c5be4a28b5984765f3d">&#9670;&nbsp;</a></span>lecbeam()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.lecbeam </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>blev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Analysis of source above background in a lobster eye cross-beam
    arr      image array
    s        size of cross-beam square area in pixels
    h        height of cross-arm quadrant in pixels (=2d/L)
    blev     average background level per pixel (to be subtracted)
    bvar     variance on blev (-ve for counting statistics)
    nt       dimension of output quadrant flux distribution in pixels
return   list of the following:
    qua      quadrant surface brightness distribution array nt by nt
    quan     quadrant  pixel occupancy array nt by nt
    nsam     number of pixels in beam
    bflux    background in beam (e.g. counts)
    bsigma   standard deviation of background
    flux     source flux above background in beam (e.g. counts)
    fsigma   standard deviation of source flux
    peak     source x,y peak position
    cen      source x,y centroid position
    hew      half energy width (pixels)
    w90      W90 (90% width) (pixels)
    ahew     half energy area (sq pixels)
    aw90     W90 (90% width) area (sq pixels)
    fpeak    flux in peak pixel
The position of the beam is the current position within the image. Use function setpos() to set the current position.
</pre> 
</div>
</div>
<a id="a09118bff749ce221bcab7cbc813f3e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09118bff749ce221bcab7cbc813f3e5e">&#9670;&nbsp;</a></span>lecimage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.lecimage </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xcen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ycen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create an image array of the lobster eye cross-beam
    s       size of cross-beam square area in pixels
    h       height of cross-arm triangle in pixels (=2d/L)
    b       jwidth of cross-arm triangle in pixels
    xcen    centre pixel (see coords below)
    ycen    centre pixel (see coords below)
    nx      first dimension of array
    ny      second dimension of array
return  image array
    Coordinate system for xcen,ycen is:
    x runs from 0.0 on left to nx on right
    Y runs from 0.0 on bottom to ny on top
    Centre of bottom left pixel is therefore 0.5,0.5
    Centre of top right pixel is nx-0.5,ny-0.5
</pre> 
</div>
</div>
<a id="abf1baa121ee75e999c92c7f23b7dc42e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf1baa121ee75e999c92c7f23b7dc42e">&#9670;&nbsp;</a></span>lepsf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.lepsf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xcen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ycen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create an image of the lobster eye PSF
    s       size of cross-beam square area in pixels
    h       height of cross-arm triangle in pixels (=2d/L)
    g       width of Lorentzian central spot in pixels
    eta     cross-arm to peak ratio at centre
    xcen    centre of PSF (see below for coords. system)
    ycen    centre of PSF (see below for coords. system)
    nx      first dimension of array
    ny      second dimension of array
return  image array
    Coordinate system for xcen,ycen is:
    x runs from 0.0 on left to nx on right
    Y runs from 0.0 on bottom to ny on top
    Centre of bottom left pixel is therefore 0.5,0.5
    Centre of top right pixel is nx-0.5,ny-0.5
</pre> 
</div>
</div>
<a id="ae7c9d2cea3fe9a06533d6823fb7065d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c9d2cea3fe9a06533d6823fb7065d2">&#9670;&nbsp;</a></span>peakchisq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.peakchisq </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fpars</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Chi-squared for image peak fitting
    fpars       array of fitting parameters
                parameter 1 normalisation (value at peak)
                parameter 2 x-centre (pixel position)
                parameter 3 y-centre (pixel position)
                parameter 4 Lorentian width (pixels) 24th Sept. 2017 RW
return      Chi-squared value
    Used by function beam() which loads Fortran common block BEAMFIT with image data.
</pre> 
</div>
</div>
<a id="a8faa811be5f0e7dea19b18e20bbc76e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8faa811be5f0e7dea19b18e20bbc76e9">&#9670;&nbsp;</a></span>quaderr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.quaderr </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Quadratic estimator for confidence limit
    x0,y0   parameter and statistic at minimum
    x1,y1   parameter and statistic near minimum
    y       required statistic value
return  estimate of parameter corresponding to y
</pre> 
</div>
</div>
<a id="aef48128ba9b2f8644c43c09f80f20fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef48128ba9b2f8644c43c09f80f20fa0">&#9670;&nbsp;</a></span>rectangles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.rectangles </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Draw rectangles
    x,y   centre positions
    w,h   widths and heights
    t     rotation angles radians
</pre> 
</div>
</div>
<a id="a4f1351dead951fa6728f4f26e6471859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f1351dead951fa6728f4f26e6471859">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reset common blocks to initial condition</pre> 
</div>
</div>
<a id="a3b0ccac946edc83732a3f3d384923ecd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b0ccac946edc83732a3f3d384923ecd">&#9670;&nbsp;</a></span>setfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.setfield </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xleft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xright</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ybot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ytop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Set local coordinates for image field
    nx     number of columns
    xleft  local x left edge
    xright local x right edge
    ny     number of rows
    ybot   local y bottom edge
    ytop   local y top edge
</pre> 
</div>
</div>
<a id="a3c53030859724daa5e9f1a7ff57ecf3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c53030859724daa5e9f1a7ff57ecf3a">&#9670;&nbsp;</a></span>setpos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.setpos </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ipos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Set current position in image field
    ipos    coordinate index
        1 pixel 0-NCOLS, 0-NROWS
        2 local X,Y
        3 local azimuth,elevation degrees
        4 Celestial RA,DEC degrees J2000
        5 Ecliptic EA,EL degrees
        6 Galactic LII,BII degrees
    p       position coordinate pair
</pre> 
</div>
</div>
<a id="a7d6713340c9393df65d12c8950f974f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6713340c9393df65d12c8950f974f4">&#9670;&nbsp;</a></span>setsky()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.setsky </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xtodeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ytodeg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ipr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>roll</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Set sky coordinates for image field
    xtodeg  scale from local x to degrees (usually -ve)
    ytodeg  scale from local y to degrees
    ipr     projection between local XY and local spherical
        0 Plate Carre
        1 Aitoff (Hammer)
        2 Lambert (equatorial aspect of Azimuthal equal-area projection)
    mjd     Modified Julian date
    ra      Right Ascension (degrees J2000 at local origin)
    dev     Declination (degrees J2000 at local origin)
    roll    Roll angle (degrees from North to +ve elev. +ve clockwise)
</pre> 
</div>
</div>
<a id="a7ce1b8de9c2c387025e825e92846dc13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce1b8de9c2c387025e825e92846dc13">&#9670;&nbsp;</a></span>srchmin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.srchmin </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>delstat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>derr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Search for minimum statistic and return best fit parameters and confidence limits of the parameters
    pars        initial parameter values
    pl          hard lower limit of parameter values
    ph          hard upper limit of parameter values
    stat        the statistic function to be minimised
    delstat     the change in statistic for confidence limits
    derr        initial error estimates for parameters
                0 fixed, &gt;0 to estimate confidence range
returns     list from optim() plus confidence limits parlo and parhi
    The statistic function call must return the value of a statistic with call of form stat(pars).
</pre> 
</div>
</div>
<a id="a5a4b780aa3a5620fdc96c7d8c5e7be4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4b780aa3a5620fdc96c7d8c5e7be4e">&#9670;&nbsp;</a></span>toxy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def images.toxy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ipos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert position to local xy coordinates
    ipos    coordinate index
        1 pixel 0-NCOLS, 0-NROWS
        2 local X,Y
        3 local azimuth,elevation degrees
        4 Celestial RA,DEC degrees J2000
        5 Ecliptic EA,EL degrees
        6 Galactic LII,BII degrees
return  position as local xy
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
